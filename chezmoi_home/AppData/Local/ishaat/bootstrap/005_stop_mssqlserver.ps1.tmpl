{{ if eq .chezmoi.os "windows" }}

{{ template "ps1/bootstrap-common.ps1" . }}

Write-Header "Disable and stop MSSQLSERVER service (if installed)"

# Ensure the script only runs on Windows
if ($env:OS -ne 'Windows_NT') {
    Write-Host "This script is only intended to run on Windows."
    return
}

# Check if MSSQLSERVER service exists
$service = Get-Service -Name 'MSSQLSERVER' -ErrorAction SilentlyContinue

if ($null -eq $service) {
    Write-Host "MSSQLSERVER service is not installed."
    return
}

Write-Host "Disabling MSSQLSERVER..."
Set-Service -Name 'MSSQLSERVER' -StartupType Disabled

# Stop the service only if it's running
if ($service.Status -ne 'Stopped') {
    Write-Host "Stopping MSSQLSERVER service..."
    Stop-Service -Name 'MSSQLSERVER' -Force
    Write-Host "MSSQLSERVER service stopped."
} else {
    Write-Host "MSSQLSERVER service is already stopped."
}
{{ end }}